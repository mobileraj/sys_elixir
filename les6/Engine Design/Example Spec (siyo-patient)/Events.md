**Currently: implemented**

This WIP document defines the current events which the siyo.clinic web project emit, along with the schemas of events in general. This document does not define whether events are sent from the frontend (website) of siyo.clinic or the backend (see mock-backends). 
## What is an event?
An event is an atomic description of the initiation or result of an action, either performed by the system or the user. It is "something that happened", used primarily for debugging and business purposes.

## General Schema
Here is a rough example schema of an event as a pydantic model (please refer to the actual implementation):
```python
class Event(pydantic.BaseModel):
	timestamp: datetime;
	encounter_code: str;
	event_type: str;
	status: str; #'PENDING' | 'UNVERIFIED' | 'FAIL' | 'SUCCESS' | 'UNKNOWN'
	phase: str;
	phase_error: str | None = None;
	source: str;
	source_type: str; #'USER' | 'SYSTEM_FUH_REQUEST' | 'SYSTEM_INTERNAL'
	error: dict | None = None;
	message: str;
```
Comments:
- `timestamp` is when the event was fired
- `encounter_code` is the associated encounter code 
- `event_type` is one the event types described below in this document
- `status` describes the progress of the event, whether this event describes an action that was initiated, completed successfully, or completed unsuccessfully. For user actions, can also be 'UNVERIFIED', which is a failure due to an unverified user. 
- `phase` is one of the phases as described in the [[Phases of Encounter Lifetime]] document
- `phase_error`, if non null, indicates that the event reported was not allowed in the current phase of the encounter lifetime
	- For example, if a `APPOINTMENT_BOOKED` event appeared in the `IN_CALL` phase.
- `source` is equivalent to the `medium` field in `app_events`
- `sourceType` indicates whether the event was generated by:
	- `USER` -  the direct action of the user
	- `SYSTEM_FUH_REQUEST` -  a request to the fuh backend by the siyo.clinic backend
	- `SYSTEM_INTERNAL` -  an internal action done by the siyo.clinic backend.
- `error` is an arbitrary dictionary representing the error/exception.
- `message` is a human readable string describing the event

## Event Types:
Organized by `sourceType`:
- USER:
	- VERIFICATION_SENT
	- VERIFIED
	- TOS_VIEWED
	- TOS_ACCEPTED
	- TOS_REJECTED
	- APPOINTMENTS_VIEWED
	- APPOINTMENT_BOOKED
	- APPOINTMENT_CANCELLED
	- JOINED_CALL
	- LEFT_CALL
- SYSTEM_FUH_REQUEST: 
	- FUH_GET_ENCOUNTER
	- FUH_GET_TIMESLOTS
	- FUH_BOOK_APPOINTMENT
	- FUH_CANCEL_APPOINTMENT
	- FUH_SET_TOS
- SYSTEM_INTERNAL: *currently none, likely will change in the future*
